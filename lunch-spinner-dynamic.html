<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lunch Spinner</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    canvas {
      border: 2px solid #333;
      margin-top: 20px;
    }
    select, button {
      padding: 10px;
      font-size: 16px;
      margin-top: 20px;
    }
    #result {
      font-size: 20px;
      margin-top: 20px;
      color: #333;
    }
  </style>
</head>
<body>

  <h1>Where Should I Eat Lunch?</h1>
  <p>Spin the wheel to pick a delicious restaurant!</p>

  <label for="category">Choose a category:</label>
  <select id="category" onchange="updateWheel()">
    <option value="Pizza">Pizza</option>
    <option value="Bakeries & sweets">Bakeries & sweets</option>
    <option value="Breakfast">Breakfast</option>
    <option value="Breweries & tap houses">Breweries & tap houses</option>
    <option value="Chinese">Chinese</option>
    <option value="Coffee">Coffee</option>
    <option value="Drinks">Drinks</option>
    <option value="Japanese">Japanese</option>
    <option value="Mexican">Mexican</option>
    <option value="Misc Food">Misc Food</option>
    <option value="Thai">Thai</option>
    <option value="Vietnamese">Vietnamese</option>
    <option value="High-end dining">High-end dining</option>
  </select>

  <br>
  <canvas id="wheelCanvas" width="500" height="500"></canvas>
  <br>
  <button id="spinBtn">Spin!</button>
  <div id="result"></div>

  <script>
    const restaurantData = {
      "Pizza": ["Pizza Supreme Being", "Majka Pizza", "Masullo", "Pizzasaurus Rex", "Chavious"],
      "Bakeries & sweets": ["Faria", "Guenther’s Ice Cream", "Vic’s Ice Cream", "Broadway Donuts", "Stanley Donuts"],
      "Breakfast": ["Camellia", "Forgotten Bakery", "Morning Fork", "Pushkin’s", "Druthers Sutter Park"],
      "Breweries & tap houses": ["SacYard", "At Ease Brewing", "Urban Roots", "Nitty’s Cider", "Bike Dog"],
      "Chinese": ["Dumpling and Tea House", "Journey to the Dumpling", "Ming Dynasty", "Asian Pearl", "Frank Fat’s"],
      "Coffee": ["Pachamama", "Camellia", "Immortal Cafe", "Old Soul", "Temple Coffee"],
      "Drinks": ["Ten Ten Room", "The Snug", "Ro Sham Beaux", "Betty's Wine Bar", "Ju Ju Kitchen"],
      "Japanese": ["Kru", "Binchoyaki", "Mahroba Japanese Bakery", "Mikuni"],
      "Mexican": ["Tres Hermanas", "La Fiesta Taqueria", "El Rincon Mexican", "Nopalitos"],
      "Misc Food": ["Hook & Ladder", "MOTHER", "Mecha Mucha"],
      "Thai": ["Thai Farmhouse", "Kin Thai Street Eatery", "Coconut on T"],
      "Vietnamese": ["Saigon Alley"],
      "High-end dining": ["Canon", "Mulvaney’s B&L", "Ella", "The Kitchen"]
    };

    let restaurants = restaurantData["Pizza"]; // Default category
    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");
    const spinBtn = document.getElementById("spinBtn");
    const resultDiv = document.getElementById("result");
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = 200;
    let numOptions = restaurants.length;
    let arc = Math.PI * 2 / numOptions;
    let startAngle = 0;
    let spinTime = 0;
    let spinTimeTotal = 0;
    let spinning = false;
    let finalAngle = 0;

    const colors = ["#FF5733", "#33FFCE", "#FF33F6", "#335BFF", "#B6FF33", "#FFBD33", "#8C33FF"];

    function updateWheel() {
      const category = document.getElementById("category").value;
      restaurants = restaurantData[category] || [];
      numOptions = restaurants.length;
      arc = Math.PI * 2 / numOptions;
      drawWheel();
    }

    function drawWheel() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < numOptions; i++) {
        let angle = startAngle + i * arc;
        ctx.fillStyle = colors[i % colors.length];
        ctx.beginPath();
        ctx.moveTo(centerX, centerY);
        ctx.arc(centerX, centerY, radius, angle, angle + arc, false);
        ctx.fill();
        ctx.save();
        ctx.fillStyle = "#fff";
        ctx.translate(centerX, centerY);
        ctx.rotate(angle + arc / 2);
        ctx.textAlign = "right";
        ctx.font = "bold 16px sans-serif";
        ctx.fillText(restaurants[i], radius - 10, 10);
        ctx.restore();
      }
      ctx.beginPath();
      ctx.arc(centerX, centerY, 30, 0, Math.PI * 2, false);
      ctx.fillStyle = "#333";
      ctx.fill();
    }

    function spin() {
      if (spinning) return;
      spinning = true;
      spinTime = 0;
      spinTimeTotal = Math.random() * 3000 + 3000;
      animateSpin();
    }

    function animateSpin() {
      spinTime += 30;
      if (spinTime >= spinTimeTotal) {
        stopSpin();
        return;
      }
      const spinAngle = easeOut(spinTime, 0, finalAngle, spinTimeTotal);
      startAngle += (spinAngle * Math.PI / 180);
      drawWheel();
      requestAnimationFrame(animateSpin);
    }

    function stopSpin() {
      const degrees = startAngle * 180 / Math.PI % 360;
      const index = Math.floor((360 - degrees + (arc * 180 / Math.PI)/2) % 360 / (360 / numOptions));
      resultDiv.innerHTML = "Today's lunch: <strong>" + restaurants[index] + "</strong>!";
      spinning = false;
    }

    function easeOut(t, b, c, d) {
      const ts = (t /= d) * t;
      const tc = ts * t;
      return b + c * (tc + -3 * ts + 3 * t);
    }

    spinBtn.addEventListener("click", function() {
      finalAngle = Math.random() * 500 + 500;
      resultDiv.innerHTML = "";
      spin();
    });

    drawWheel();
  </script>

</body>
</html>