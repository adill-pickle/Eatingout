<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunch Spinner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        select, button {
            padding: 10px;
            margin: 10px;
            font-size: 16px;
        }
        .wheel-container {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 5px solid #333;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        .spinner {
            font-size: 18px;
            color: white;
            text-align: center;
        }
    </style>
</head>
<body>

    <h1>Lunch Spinner</h1>

    <label for="city">Select City (within 20 miles of Sacramento):</label>
    <select id="city" onchange="getFoodGenres()"></select>

    <label for="foodGenre">Select Food Genre:</label>
    <select id="foodGenre"></select>

    <button onclick="getRestaurant()">Spin and Get a Lunch Spot</button>

    <div class="wheel-container">
        <div id="spinner" class="spinner">Spin to Find a Place!</div>
    </div>

    <script>
        const apiKey = "AIzaSyAu3wgBYxwa9LWkDLdHGl9oTFsekMUzH8c"; // Replace with your API Key
        const baseUrl = "https://maps.googleapis.com/maps/api/place/textsearch/json?";

        // Hardcoded list of cities within 20 miles of Sacramento
        const cities = ["Sacramento", "Roseville", "Folsom", "Elk Grove", "Citrus Heights", "Rancho Cordova", "Rocklin"];

        // Predefined list of food genres
        const foodGenres = ["Mexican", "Italian", "Chinese", "Indian", "Japanese", "Thai", "BBQ", "Vegan", "American", "Seafood"];

        // Populate the city dropdown
        function getNearbyCities() {
            const citySelect = document.getElementById("city");
            citySelect.innerHTML = ""; // Clear existing options

            cities.forEach(city => {
                const option = document.createElement("option");
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });

            // Automatically load food genres for the first city
            getFoodGenres();
        }

        // Populate the food genre dropdown
        function getFoodGenres() {
            const genreSelect = document.getElementById("foodGenre");
            genreSelect.innerHTML = ""; // Clear previous options

            foodGenres.forEach(genre => {
                const option = document.createElement("option");
                option.value = genre;
                option.textContent = genre;
                genreSelect.appendChild(option);
            });
        }

        // Fetch a restaurant from Google Places API
        async function getRestaurant() {
            const genre = document.getElementById("foodGenre").value;
            const city = document.getElementById("city").value;

            if (!genre || !city) {
                document.getElementById("spinner").innerText = "Please select a city and a food genre.";
                return;
            }

            const query = `${genre} restaurant in ${city}`;
            const url = `${baseUrl}query=${encodeURIComponent(query)}&key=${apiKey}`;

            try {
                const response = await fetch(url);
                const data = await response.json();
                console.log("API Response:", data);

                if (data.results && data.results.length > 0) {
                    const randomPlace = data.results[Math.floor(Math.random() * data.results.length)];
                    document.getElementById("spinner").innerText = randomPlace.name;
                } else {
                    document.getElementById("spinner").innerText = "No results found.";
                }
            } catch (error) {
                console.error("Error fetching restaurant:", error);
                document.getElementById("spinner").innerText = "Error fetching results.";
            }
        }

        // Initialize the dropdowns on page load
        window.onload = getNearbyCities;
    </script>

</body>
</html>