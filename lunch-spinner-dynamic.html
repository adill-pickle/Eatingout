<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunch Spinner</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        select, button {
            padding: 10px;
            margin: 10px;
            font-size: 16px;
        }
        .wheel-container {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 5px solid #333;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }
        .spinner {
            font-size: 18px;
            color: black;
            text-align: center;
            padding: 10px;
        }
    </style>
</head>
<body>

    <h1>Lunch Spinner</h1>

    <label for="city">Select City (within 20 miles of Sacramento):</label>
    <select id="city" onchange="populateFoodGenres(this.value)"></select>

    <label for="foodGenre">Select Food Genre:</label>
    <select id="foodGenre"></select>

    <button onclick="getRestaurant()">Spin and Get a Lunch Spot</button>

    <div class="wheel-container">
        <div id="spinner" class="spinner">Spin to Find a Place!</div>
    </div>

    <script>
        const googleApiKey = "YOUR_GOOGLE_API_KEY"; // Replace with your Google API Key
        const cx = "YOUR_CSE_ID"; // Replace with your Custom Search Engine ID
        const cities = ["Sacramento", "Roseville", "Elk Grove", "Folsom", "Davis"];
        const foodGenres = {
            "Sacramento": ["Italian", "Mexican", "Chinese", "Japanese", "American"],
            "Roseville": ["Italian", "Mexican", "Chinese", "Japanese", "American"],
            "Elk Grove": ["Italian", "Mexican", "Chinese", "Japanese", "American"],
            "Folsom": ["Italian", "Mexican", "Chinese", "Japanese", "American"],
            "Davis": ["Italian", "Mexican", "Chinese", "Japanese", "American"]
        };

        function populateCities() {
            const citySelect = document.getElementById("city");
            cities.forEach(city => {
                const option = document.createElement("option");
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });
        }

        function populateFoodGenres(city) {
            const genreSelect = document.getElementById("foodGenre");
            genreSelect.innerHTML = ''; // Clear existing options

            const genres = foodGenres[city];
            genres.forEach(genre => {
                const option = document.createElement("option");
                option.value = genre;
                option.textContent = genre;
                genreSelect.appendChild(option);
            });
        }

        async function getRestaurant() {
            const genre = document.getElementById("foodGenre").value;
            const city = document.getElementById("city").value;
            const query = `${genre} restaurants in ${city} reviews`;
            const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${googleApiKey}&cx=${cx}`;

            try {
                const response = await fetch(url);
                const data = await response.json();
                console.log("Search results:", data); // Debugging log

                if (data.items && data.items.length > 0) {
                    const topResults = data.items.slice(0, 10).map(item => item.title);
                    const randomPlace = topResults[Math.floor(Math.random() * topResults.length)];
                    document.getElementById("spinner").innerText = randomPlace;
                } else {
                    document.getElementById("spinner").innerText = "No results found.";
                }
            } catch (error) {
                console.error("Error fetching data from Google CSE API:", error);
                document.getElementById("spinner").innerText = "Error fetching results.";
            }
        }

        window.onload = () => {
            populateCities();
        }
    </script>

</body>
</html>